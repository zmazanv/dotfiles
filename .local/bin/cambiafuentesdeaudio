#!/usr/bin/env -S bash -u

__AUDIO_SINK="$(pactl info | grep 'Default Sink' | cut -d ' ' -f 3)"
[[ -z "${__AUDIO_SINK}" ]] && exit 1

declare -A __SCHIIT_MODIUS
__SCHIIT_MODIUS['name']='alsa_output.usb-Schiit_Audio_Schiit_Unison_Modius-00.analog-stereo'
__SCHIIT_MODIUS['nick']='Schiit Modius'

declare -A __MOTHERBOARD_OUT
__MOTHERBOARD_OUT['name']='alsa_output.pci-0000_0c_00.4.analog-stereo'
__MOTHERBOARD_OUT['nick']='Logitech Z10'

case "${__AUDIO_SINK}" in
    "${__SCHIIT_MODIUS['name']}")
        pactl set-default-sink "${__MOTHERBOARD_OUT['name']}"
        dunstify -u normal -r 100 -t 2000 "ðŸ”Š Fuente de Audio" "Se ha cambiado la fuente de audio a '${__MOTHERBOARD_OUT['nick']}'."
        exit 0
        ;;
    "${__MOTHERBOARD_OUT['name']}")
        pactl set-default-sink "${__SCHIIT_MODIUS['name']}"
        dunstify -u normal -r 100 -t 2000 "ðŸ”Š Fuente de Audio" "Se ha cambiado la fuente de audio a '${__SCHIIT_MODIUS['nick']}'."
        exit 0
        ;;
    *)
        dunstify -u critical -r 100 "ðŸ”Š Fuente de Audio" "No se pudo cambiar la fuente de audio.\n\nSalida actual:\n- ${__AUDIO_SINK}\n\nNo se encontraron las siguientes salidas:\n- ${__SCHIIT_MODIUS['name']}\n- ${__MOTHERBOARD_OUT['name']}"
        exit 1
        ;;
esac
